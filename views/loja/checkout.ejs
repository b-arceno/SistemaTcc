<%- include('../partials/header') %>

<h2>Finalizar Pedido</h2>

<% if (!carrinho || carrinho.length === 0) { %>
  <p>Seu carrinho está vazio. <a href="/loja">Voltar à loja</a></p>
<% } else { %>

  <table border="1" cellpadding="8" cellspacing="0">
    <tr>
      <th>Produto</th>
      <th>Quantidade</th>
      <th>Preço Unitário</th>
      <th>Subtotal</th>
    </tr>
    <% let total = 0; %>
    <% carrinho.forEach(p => { %>
      <% total += p.preco * p.quantidade; %>
      <tr>
        <td><%= p.nome %></td>
        <td><%= p.quantidade %></td>
        <td>R$ <%= p.preco.toFixed(2) %></td>
        <td>R$ <%= (p.preco * p.quantidade).toFixed(2) %></td>
      </tr>
    <% }) %>
    <tr>
      <td colspan="3" align="right"><strong>Total:</strong></td>
      <td><strong>R$ <%= total.toFixed(2) %></strong></td>
    </tr>
  </table>

  <form action="/loja/finalizar" method="POST" style="margin-top: 20px;">
    <label for="forma_pagamento">Forma de Pagamento:</label>
    <select name="forma_pagamento" id="forma_pagamento" required>
      <option value="1">Dinheiro</option>
      <option value="2">Cartão</option>
      <option value="3">Pix</option>
    </select>

    <br><br>
    <button type="submit" class="btn">Confirmar Pedido</button>
  </form>

<% } %>

<%- include('../partials/footer') %>
